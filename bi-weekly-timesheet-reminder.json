{
  "schema_version": 25,
  "standard_lib_version": 66,
  "action_runtime_version": 18,
  "name": "Bi-weekly timesheet reminder",
  "description": null,
  "guid": "85795c38cbe8534a8d347d5b70bd4294",
  "slug": "bi_weekly_timesheet_reminder",
  "agents": [
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Check biweekly timesheet reminder",
      "disabled": false,
      "description": null,
      "guid": "bcbdf452c3f9a5540697b5334878689e",
      "origin_story_identifier": "cloud:14fe6345f70f34c7d582c9425dfa4916:85795c38cbe8534a8d347d5b70bd4294",
      "options": {
        "mode": "automatic",
        "input": "=",
        "guidance": "\"This automation should perform the following check and actions:  \n\nIF:  \n- Current time is between 8:00 AM and 9:00 AM AND  \n- Current day is Friday AND  \n- It matches the biweekly pattern (if initial email sent on Week 1 Friday, next email should be sent on Week 3 Friday, then Week 5 Friday, and so on)\n\nTHEN:  \nReturn/generate a friendly reminder email with:\n\nSubject: Timesheet Submission Reminder\n\nBody:  \n<html>\n<body style='font-family: Arial, sans-serif; line-height: 1.6;'>\n    <p>Dear Parking Services Team,</p>\n    \n    <p>This is a friendly reminder to submit your hours.</p>\n    \n    <p>Important details:</p>\n    <ul style='margin-left: 20px;'>\n        <li>Submit your hours through Workday</li>\n        <li>Deadline : 4 PM</li>\n        <li> Record your hours accurately</li>\n        <li>Failure of submission will delay in payroll processing</li>\n    </ul>\n    \n    <p style='margin-top: 20px;'>Best,<br>\n    GVSU PARKING SERVICES</p>\n</body>\n</html>\n\nELSE:  \nReturn the string 'Not time to send reminder yet'\n\nNote: If the first email is sent on Week 1 Friday, the automation will schedule subsequent emails for Week 3 Friday, Week 5 Friday, and continue this pattern every other week.\"",
        "language": "Python",
        "script": "from datetime import datetime, timedelta\n\ndef main(input):\n    # Get current datetime\n    now = datetime.now()\n    \n    # Check if current day is Friday\n    is_friday = now.weekday() == 4\n    \n    # Check if current time is between 8:00 AM and 9:00 AM\n    is_time_window = 8 <= now.hour < 9\n    \n    # Calculate week number since a reference start date\n    reference_date = datetime(2023, 1, 6)  # First Friday as reference\n    weeks_since_reference = (now - reference_date).days // 7\n    \n    # Check if it's a biweekly Friday (Week 1, 3, 5, etc.)\n    is_biweekly_friday = weeks_since_reference % 2 == 0\n    \n    # Conditions for sending reminder\n    if is_friday and is_time_window and is_biweekly_friday:\n        return {\n            'subject': 'Timesheet Submission Reminder',\n            'body': '''<html>\n<body style='font-family: Arial, sans-serif; line-height: 1.6;'>\n    <p>Dear Parking Services Team,</p>\n    \n    <p>This is a friendly reminder to submit your hours.</p>\n    \n    <p>Important details:</p>\n    <ul style='margin-left: 20px;'>\n        <li>Submit your hours through Workday</li>\n        <li>Deadline : 4 PM</li>\n        <li> Record your hours accurately</li>\n        <li>Failure of submission will delay in payroll processing</li>\n    </ul>\n    \n    <p style='margin-top: 20px;'>Best,<br>\n    GVSU PARKING SERVICES</p>\n</body>\n</html>'''\n        }\n    \n    return 'Not time to send reminder yet'"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EmailAgent",
      "name": "Send timesheet reminder email",
      "disabled": false,
      "description": null,
      "guid": "15d270fa65af6247f510bd7755cdd74c",
      "origin_story_identifier": "cloud:14fe6345f70f34c7d582c9425dfa4916:85795c38cbe8534a8d347d5b70bd4294",
      "options": {
        "recipients": [
          ".....@gmail.com"
        ],
        "reply_to": "......@gmail.com",
        "sender_name": "........",
        "subject": "<<check_biweekly_timesheet_reminder.output.subject>>",
        "body": "<<reminder_message.output.body>>",
        "advanced_html": true
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    }
  ],
  "diagram_notes": [],
  "links": [
    {
      "source": 0,
      "receiver": 1
    }
  ],
  "diagram_layout": "{\"bcbdf452c3f9a5540697b5334878689e\":[150,-45],\"15d270fa65af6247f510bd7755cdd74c\":[150,60]}",
  "send_to_story_enabled": false,
  "entry_agent_guid": null,
  "exit_agent_guids": [],
  "exit_agent_guid": null,
  "api_entry_action_guids": [],
  "api_exit_action_guids": [],
  "keep_events_for": 86400,
  "reporting_status": true,
  "send_to_story_access": null,
  "story_library_metadata": {},
  "parent_only_send_to_story": false,
  "monitor_failures": false,
  "send_to_stories": [],
  "synchronous_webhooks_enabled": false,
  "send_to_story_access_source": 0,
  "send_to_story_skill_use_requires_confirmation": true,
  "pages": [],
  "tags": [],
  "time_saved_unit": "minutes",
  "time_saved_value": 0,
  "origin_story_identifier": "cloud:14fe6345f70f34c7d582c9425dfa4916:85795c38cbe8534a8d347d5b70bd4294",
  "integration_product": null,
  "integration_vendor": null,
  "llm_product_instructions": "",
  "exported_at": "2024-12-18T23:32:15Z",
  "icon": ":magnet:",
  "integrations": []
}
